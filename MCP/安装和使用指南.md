# VSCode Commands MCP 安装和使用指南

## 当前状态分析

✅ **MCP服务器** - 已成功运行
- 服务器正在监听端口8765
- MCP工具已正确配置
- 可以接收命令请求

❌ **VSCode扩展** - 未连接
- 扩展需要安装到VSCode中
- 扩展负责在当前窗口执行VSCode命令

## 安装VSCode扩展的步骤

### 方法1：开发模式运行（推荐用于测试）

1. **打开VSCode扩展项目**
   ```bash
   cd "C:\Users\70912\Documents\Cline\MCP\vscode-commands-extension"
   ```

2. **在VSCode中打开扩展项目**
   - 打开VSCode
   - 选择 "File" → "Open Folder"
   - 选择 `vscode-commands-extension` 文件夹

3. **运行扩展**
   - 按 `F5` 键启动扩展开发主机
   - 这将打开一个新的VSCode窗口，扩展已激活

4. **测试功能**
   - 在新窗口中，使用Cline插件
   - 输入 "打开资源管理器面板"
   - 应该能看到资源管理器面板打开

### 方法2：打包安装扩展

1. **打包扩展**
   ```bash
   cd "C:\Users\70912\Documents\Cline\MCP\vscode-commands-extension"
   npm install -g @vscode/vsce
   vsce package
   ```

2. **安装扩展**
   - 在VSCode中按 `Ctrl+Shift+P`
   - 输入 "Extensions: Install from VSIX"
   - 选择生成的 `.vsix` 文件

### 方法3：手动复制扩展

1. **复制扩展文件**
   - 将 `vscode-commands-extension` 文件夹复制到VSCode扩展目录：
   - Windows: `%USERPROFILE%\.vscode\extensions\vscode-commands-extension-0.1.0\`

2. **重启VSCode**
   - 完全关闭VSCode
   - 重新打开VSCode

## 验证安装成功

安装扩展后，您应该能看到：

1. **扩展已激活**
   - 在扩展面板中搜索 "VSCode Commands Extension for MCP"
   - 确认扩展已启用

2. **连接状态**
   - 检查MCP服务器终端输出
   - 应该显示 "VSCode extension connected"

3. **测试功能**
   - 在Cline插件中输入命令
   - 观察当前VSCode窗口的变化

## 故障排除

### 扩展未连接
- 确保扩展已安装并启用
- 检查VSCode开发者工具控制台是否有错误
- 确认MCP服务器正在运行

### 命令执行失败
- 检查VSCode版本兼容性
- 确认扩展有必要的权限
- 查看扩展日志输出

### WebSocket连接问题
- 确认端口8765未被其他程序占用
- 检查防火墙设置
- 验证网络连接

## 立即测试

一旦扩展安装成功，您就可以使用以下命令：

- "打开资源管理器面板"
- "打开搜索面板" 
- "分割编辑器"
- "切换到深色主题"
- "打开当前文件夹"

所有操作都将在**当前VSCode窗口**中执行，不会打开新窗口！
